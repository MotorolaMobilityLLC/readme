#!/bin/bash
my_top_dir=$PWD

mkdir -vp $my_top_dir/prebuilts/gcc/linux-x86/aarch64

cd $my_top_dir/prebuilts/gcc/linux-x86/aarch64

git clone https://android.googlesource.com/platform/prebuilts/gcc/linux-x86/aarch64/aarch64-linux-android-4.9


mkdir -vp $my_top_dir/prebuilts/clang/host/linux-x86

cd $my_top_dir/prebuilts/clang/host/linux-x86

git clone https://android.googlesource.com/platform/prebuilts/clang/host/linux-x86

mkdir -vp $my_top_dir/kernel-4.19

cd $my_top_dir/kernel-4.19

git clone git@github.com:MotorolaMobilityLLC/kernel-mtk.git -b android-12-release-STAS32.79-77-28-63-9


cross=$my_top_dir/prebuilts/gcc/linux-x86/aarch64/aarch64-linux-android-4.9/bin/aarch64-linux-android-
cc_path=$my_top_dir/prebuilts/clang/host/linux-x86/clang-r383902/bin/clang
ld_path=$my_top_dir/prebuilts/clang/host/linux-x86/clang-r383902/bin/ld.lld

#mkdir out/
kernel_out_dir=$my_top_dir/kernel-4.19/out
export JOURNEY_BUILD_SCRIPT=yes
export ARCH=arm64
export SUBARCH=arm64
export HEADER_ARCH=arm64
export CLANG_TRIPLE=aarch64-linux-gnu-
cd $my_top_dir/kernel-4.19/
cp arch/arm64/configs/p410ae_defconfig p410ae_defconfig

make O=$kernel_out_dir ARCH=arm64 CC=$cc_path LD=$ld_path p410ae_defconfig
make -j8 O=$kernel_out_dir ARCH=arm64 CC=$cc_path LD=$ld_path CROSS_COMPILE=$cross
